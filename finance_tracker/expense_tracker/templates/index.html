{% extends 'base.html' %}

{% block content %}
<h2 class="text-xl font-semibold mb-4">All Transactions</h2>

<!-- Chart Section -->
<canvas id="financeChart" class="mb-8 bg-white p-4 rounded shadow" height="100"></canvas>

<!-- Table Section -->
<table class="w-full text-left bg-white shadow-md rounded">
  <thead class="bg-blue-100">
    <tr>
      <th class="py-2 px-3">Date</th>
      <th class="py-2 px-3">Amount</th>
      <th class="py-2 px-3">Category</th>
      <th class="py-2 px-3">Type</th>
      <th class="py-2 px-3">Note</th>
    </tr>
  </thead>
  <tbody>
    {% for t in transactions %}
    <tr class="border-t">
      <td class="py-2 px-3">{{ t[1] }}</td>
      <td class="py-2 px-3">{{ t[2] }}</td>
      <td class="py-2 px-3">{{ t[3] }}</td>
      <td class="py-2 px-3">{{ t[5] }}</td>
      <td class="py-2 px-3">{{ t[4] }}</td>
    </tr>
    {% endfor %}
  </tbody>
</table>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  const ctx = document.getElementById('financeChart');
  const financeChart = new Chart(ctx, {
    type: 'bar',
    data: {
      labels: {{ chart_labels|safe }},
      datasets: [{
        label: 'Income',
        data: {{ income_data|safe }},
        backgroundColor: 'rgba(34,197,94,0.6)',
        borderColor: 'rgba(34,197,94,1)',
        borderWidth: 1
      }, {
        label: 'Expense',
        data: {{ expense_data|safe }},
        backgroundColor: 'rgba(239,68,68,0.6)',
        borderColor: 'rgba(239,68,68,1)',
        borderWidth: 1
      }]
    },
    options: {
      responsive: true,
      scales: {
        y: {
          beginAtZero: true
        }
      }
    }
  });
</script>
{% endblock %}
